\hypertarget{classsocketpp_1_1ICMP__IP__RawSocket}{
\section{socketpp::ICMP\_\-IP\_\-RawSocket Class Reference}
\label{classsocketpp_1_1ICMP__IP__RawSocket}\index{socketpp::ICMP\_\-IP\_\-RawSocket@{socketpp::ICMP\_\-IP\_\-RawSocket}}
}
ICMP raw socket with IP header handling.  


{\tt \#include $<$RawSocket.h$>$}

Inheritance diagram for socketpp::ICMP\_\-IP\_\-RawSocket::\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=4cm]{classsocketpp_1_1ICMP__IP__RawSocket}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{CompactItemize}
\item 
\hypertarget{classsocketpp_1_1ICMP__IP__RawSocket_c94fd53fce785a8b9ac5e53c8b1fb694}{
\hyperlink{classsocketpp_1_1ICMP__IP__RawSocket_c94fd53fce785a8b9ac5e53c8b1fb694}{ICMP\_\-IP\_\-RawSocket} ()}
\label{classsocketpp_1_1ICMP__IP__RawSocket_c94fd53fce785a8b9ac5e53c8b1fb694}

\begin{CompactList}\small\item\em constructor which calls RawSocket(ipproto\_\-udp) and setsockopt(ip\_\-hdrincl) \item\end{CompactList}\item 
\hypertarget{classsocketpp_1_1ICMP__IP__RawSocket_08d5813e94daff127499b2d1f7e93324}{
void \hyperlink{classsocketpp_1_1ICMP__IP__RawSocket_08d5813e94daff127499b2d1f7e93324}{build\_\-IP\_\-header} (\_\-u32 saddr, \_\-u32 daddr, \_\-u8 ttl=64, \_\-u8 version=4, \_\-u8 protocol=IPPROTO\_\-ICMP, \_\-u16 id=0, \_\-u8 tos=0, \_\-u16 frag\_\-off=0, \_\-u8 ihl=0, \_\-u16 tot\_\-len=0, \_\-u16 check=0)}
\label{classsocketpp_1_1ICMP__IP__RawSocket_08d5813e94daff127499b2d1f7e93324}

\begin{CompactList}\small\item\em builds the internal IP header to send \item\end{CompactList}\item 
\hypertarget{classsocketpp_1_1ICMP__IP__RawSocket_fa1f786f26097ab8008e7f022b1da2d3}{
void \hyperlink{classsocketpp_1_1ICMP__IP__RawSocket_fa1f786f26097ab8008e7f022b1da2d3}{adjust\_\-IP\_\-csum} ()}
\label{classsocketpp_1_1ICMP__IP__RawSocket_fa1f786f26097ab8008e7f022b1da2d3}

\begin{CompactList}\small\item\em sets IP checksum field \item\end{CompactList}\item 
\hypertarget{classsocketpp_1_1ICMP__IP__RawSocket_f45d8e72973d314a727e3f953dfaaf8e}{
void \hyperlink{classsocketpp_1_1ICMP__IP__RawSocket_f45d8e72973d314a727e3f953dfaaf8e}{adjust\_\-IP\_\-tot\_\-len} ()}
\label{classsocketpp_1_1ICMP__IP__RawSocket_f45d8e72973d314a727e3f953dfaaf8e}

\begin{CompactList}\small\item\em sets IP \char`\"{}total length\char`\"{} field \item\end{CompactList}\item 
\hypertarget{classsocketpp_1_1ICMP__IP__RawSocket_c3f54f7a266586af46e4bfa4494f90d6}{
void \hyperlink{classsocketpp_1_1ICMP__IP__RawSocket_c3f54f7a266586af46e4bfa4494f90d6}{adjust\_\-ICMP\_\-IP\_\-all} ()}
\label{classsocketpp_1_1ICMP__IP__RawSocket_c3f54f7a266586af46e4bfa4494f90d6}

\begin{CompactList}\small\item\em calls adjust\_\-ICMP\_\-all() \&\& \hyperlink{classsocketpp_1_1IP__RawSocket_45e60510233daaa2f279d3a4706fdce5}{adjust\_\-IP\_\-all()} \item\end{CompactList}\end{CompactItemize}
\subsection*{Static Public Member Functions}
\begin{CompactItemize}
\item 
static \_\-u16 \hyperlink{classsocketpp_1_1ICMP__IP__RawSocket_65eb1bc40fd501a49fee9055e22229dc}{ip\_\-checksum} (const struct iphdr \&ip, const struct icmphdr \&icmp, const void $\ast$payload=NULL, size\_\-t psize=0, const void $\ast$ip\_\-opt=NULL, size\_\-t ip\_\-opt\_\-len=0)
\begin{CompactList}\small\item\em calculates IP header checksum of a ICMP packet \item\end{CompactList}\item 
static \_\-u16 \hyperlink{classsocketpp_1_1ICMP__IP__RawSocket_0723a72dc06b401f6dd101a25da6348f}{ip\_\-checksum} (const struct iphdr \&ip, const struct icmphdr \&icmp, const std::string \&payload, const std::string \&ip\_\-opt)
\begin{CompactList}\small\item\em calculates IP header checksum of a ICMP packet \item\end{CompactList}\end{CompactItemize}
\subsection*{Protected Member Functions}
\begin{CompactItemize}
\item 
\hypertarget{classsocketpp_1_1ICMP__IP__RawSocket_ccfc4205717c474435dcf7e2603d1200}{
void \textbf{\_\-build\_\-packet} (std::string \&packet) const }
\label{classsocketpp_1_1ICMP__IP__RawSocket_ccfc4205717c474435dcf7e2603d1200}

\item 
\hypertarget{classsocketpp_1_1ICMP__IP__RawSocket_6d2f188d46030afa13f9c3971d43d518}{
void \textbf{\_\-set\_\-fields} (const std::string \&packet)}
\label{classsocketpp_1_1ICMP__IP__RawSocket_6d2f188d46030afa13f9c3971d43d518}

\end{CompactItemize}


\subsection{Detailed Description}
ICMP raw socket with IP header handling. 

\subsection{Member Function Documentation}
\hypertarget{classsocketpp_1_1ICMP__IP__RawSocket_0723a72dc06b401f6dd101a25da6348f}{
\index{socketpp::ICMP\_\-IP\_\-RawSocket@{socketpp::ICMP\_\-IP\_\-RawSocket}!ip\_\-checksum@{ip\_\-checksum}}
\index{ip\_\-checksum@{ip\_\-checksum}!socketpp::ICMP_IP_RawSocket@{socketpp::ICMP\_\-IP\_\-RawSocket}}
\subsubsection[{ip\_\-checksum}]{\setlength{\rightskip}{0pt plus 5cm}\_\-u16 socketpp::ICMP\_\-IP\_\-RawSocket::ip\_\-checksum (const struct iphdr \& {\em ip}, \/  const struct icmphdr \& {\em icmp}, \/  const std::string \& {\em payload}, \/  const std::string \& {\em ip\_\-opt})\hspace{0.3cm}{\tt  \mbox{[}static\mbox{]}}}}
\label{classsocketpp_1_1ICMP__IP__RawSocket_0723a72dc06b401f6dd101a25da6348f}


calculates IP header checksum of a ICMP packet 

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em ip}]IP header \item[{\em icmp}]ICMP header \item[{\em payload}]data payload field \item[{\em ip\_\-opt}]IP options field \end{description}
\end{Desc}
\begin{Desc}
\item[Returns:]checksum value \end{Desc}
\hypertarget{classsocketpp_1_1ICMP__IP__RawSocket_65eb1bc40fd501a49fee9055e22229dc}{
\index{socketpp::ICMP\_\-IP\_\-RawSocket@{socketpp::ICMP\_\-IP\_\-RawSocket}!ip\_\-checksum@{ip\_\-checksum}}
\index{ip\_\-checksum@{ip\_\-checksum}!socketpp::ICMP_IP_RawSocket@{socketpp::ICMP\_\-IP\_\-RawSocket}}
\subsubsection[{ip\_\-checksum}]{\setlength{\rightskip}{0pt plus 5cm}\_\-u16 socketpp::ICMP\_\-IP\_\-RawSocket::ip\_\-checksum (const struct iphdr \& {\em ip}, \/  const struct icmphdr \& {\em icmp}, \/  const void $\ast$ {\em payload} = {\tt NULL}, \/  size\_\-t {\em psize} = {\tt 0}, \/  const void $\ast$ {\em ip\_\-opt} = {\tt NULL}, \/  size\_\-t {\em ip\_\-opt\_\-len} = {\tt 0})\hspace{0.3cm}{\tt  \mbox{[}static\mbox{]}}}}
\label{classsocketpp_1_1ICMP__IP__RawSocket_65eb1bc40fd501a49fee9055e22229dc}


calculates IP header checksum of a ICMP packet 

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em ip}]IP header \item[{\em icmp}]ICMP header \item[{\em payload}]pointer to data payload field \item[{\em psize}]data payload size \item[{\em ip\_\-opt}]pointer to IP options field \item[{\em ip\_\-opt\_\-len}]IP options length \end{description}
\end{Desc}
\begin{Desc}
\item[Returns:]checksum value \end{Desc}


The documentation for this class was generated from the following files:\begin{CompactItemize}
\item 
RawSocket.h\item 
RawSocket.cpp\end{CompactItemize}
