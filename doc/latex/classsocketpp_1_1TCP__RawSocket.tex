\hypertarget{classsocketpp_1_1TCP__RawSocket}{
\section{socketpp::TCP\_\-RawSocket Class Reference}
\label{classsocketpp_1_1TCP__RawSocket}\index{socketpp::TCP\_\-RawSocket@{socketpp::TCP\_\-RawSocket}}
}
TCP raw socket without IP header handling.  


{\tt \#include $<$RawSocket.h$>$}

Inheritance diagram for socketpp::TCP\_\-RawSocket::\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=4cm]{classsocketpp_1_1TCP__RawSocket}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{CompactItemize}
\item 
\hypertarget{classsocketpp_1_1TCP__RawSocket_f0b76c8fdc293bb5e22914b247b1e7b8}{
\hyperlink{classsocketpp_1_1TCP__RawSocket_f0b76c8fdc293bb5e22914b247b1e7b8}{TCP\_\-RawSocket} ()}
\label{classsocketpp_1_1TCP__RawSocket_f0b76c8fdc293bb5e22914b247b1e7b8}

\begin{CompactList}\small\item\em constructor which calls RawSocket(ipproto\_\-tcp) \item\end{CompactList}\item 
\hypertarget{classsocketpp_1_1TCP__RawSocket_461e52fdfe9533077fc1f4030f086535}{
void \hyperlink{classsocketpp_1_1TCP__RawSocket_461e52fdfe9533077fc1f4030f086535}{build\_\-TCP\_\-header} (\_\-u16 source, \_\-u16 dest, \_\-u32 seq, \_\-u32 ack\_\-seq, \_\-u16 window, \_\-u8 fin=0, \_\-u8 syn=0, \_\-u8 rst=0, \_\-u8 psh=0, \_\-u8 ack=0, \_\-u8 urg=0, \_\-u8 ece=0, \_\-u8 cwr=0, \_\-u8 doff=0, \_\-u16 urg\_\-ptr=0, \_\-u16 check=0, \_\-u8 res1=0)}
\label{classsocketpp_1_1TCP__RawSocket_461e52fdfe9533077fc1f4030f086535}

\begin{CompactList}\small\item\em builds the internal TCP header \item\end{CompactList}\item 
void \hyperlink{classsocketpp_1_1TCP__RawSocket_8c35edfc4d8c2fbccf0fe13485dd2ef1}{build\_\-TCP\_\-header} (const tcphdr \&tcp)
\begin{CompactList}\small\item\em builds the internal TCP header \item\end{CompactList}\item 
void \hyperlink{classsocketpp_1_1TCP__RawSocket_c38e057fc6ece02026e71b7ee872533f}{set\_\-TCP\_\-options} (const char $\ast$opt, size\_\-t len)
\begin{CompactList}\small\item\em sets the TCP options field \item\end{CompactList}\item 
void \hyperlink{classsocketpp_1_1TCP__RawSocket_7bc9043e86c6f328cb99d98c4bfca05a}{set\_\-TCP\_\-options} (const std::string \&opt)
\begin{CompactList}\small\item\em sets the TCP options field \item\end{CompactList}\item 
void \hyperlink{classsocketpp_1_1TCP__RawSocket_c1a2ef8b2661bb0f3ca3fa6a636b25fd}{adjust\_\-TCP\_\-csum} (in\_\-addr\_\-t source, in\_\-addr\_\-t dest)
\begin{CompactList}\small\item\em sets the internal TCP pseudo-header checksum \item\end{CompactList}\item 
\hypertarget{classsocketpp_1_1TCP__RawSocket_029eb8bfbf19531253edf046775d9f5f}{
void \hyperlink{classsocketpp_1_1TCP__RawSocket_029eb8bfbf19531253edf046775d9f5f}{adjust\_\-TCP\_\-doff} ()}
\label{classsocketpp_1_1TCP__RawSocket_029eb8bfbf19531253edf046775d9f5f}

\begin{CompactList}\small\item\em sets the internal header \char`\"{}doff\char`\"{} field \item\end{CompactList}\item 
void \hyperlink{classsocketpp_1_1TCP__RawSocket_0a1017145ae76253dfca51cbd672fae7}{adjust\_\-TCP\_\-all} (in\_\-addr\_\-t source, in\_\-addr\_\-t dest)
\begin{CompactList}\small\item\em calls \hyperlink{classsocketpp_1_1TCP__RawSocket_029eb8bfbf19531253edf046775d9f5f}{adjust\_\-TCP\_\-doff()} \&\& adjust\_\-TCP\_\-csum(source,dest) \item\end{CompactList}\item 
void \hyperlink{classsocketpp_1_1TCP__RawSocket_d7e8b2a67c856e11f0e6cfff5f8b8705}{get\_\-TCP\_\-header} (tcphdr \&tcp)
\begin{CompactList}\small\item\em gets the received TCP header \item\end{CompactList}\item 
size\_\-t \hyperlink{classsocketpp_1_1TCP__RawSocket_75e954caea8187c5077821cd449199e7}{get\_\-TCP\_\-options} (char $\ast$opt, size\_\-t len)
\begin{CompactList}\small\item\em gets received TCP options \item\end{CompactList}\item 
size\_\-t \hyperlink{classsocketpp_1_1TCP__RawSocket_67ab79f764a710067590427cb35aeea0}{get\_\-TCP\_\-options} (std::string \&opt)
\begin{CompactList}\small\item\em gets received TCP options \item\end{CompactList}\end{CompactItemize}
\subsection*{Static Public Member Functions}
\begin{CompactItemize}
\item 
\hypertarget{classsocketpp_1_1TCP__RawSocket_91cf9d3aaf57d50ba1e26c8621083728}{
static \_\-u16 \textbf{tcp\_\-checksum} (const struct tcphdr \&tcp, in\_\-addr\_\-t saddr, in\_\-addr\_\-t daddr, const void $\ast$payload=NULL, size\_\-t psize=0, const void $\ast$tcp\_\-opt=NULL, size\_\-t tcp\_\-opt\_\-len=0)}
\label{classsocketpp_1_1TCP__RawSocket_91cf9d3aaf57d50ba1e26c8621083728}

\item 
\hypertarget{classsocketpp_1_1TCP__RawSocket_237a9811c114b7d38e41e9d65265b4cd}{
static \_\-u16 \textbf{tcp\_\-checksum} (const struct tcphdr \&tcp, in\_\-addr\_\-t saddr, in\_\-addr\_\-t daddr, const std::string \&payload, const std::string \&tcp\_\-opt)}
\label{classsocketpp_1_1TCP__RawSocket_237a9811c114b7d38e41e9d65265b4cd}

\item 
static \_\-u16 \hyperlink{classsocketpp_1_1TCP__RawSocket_a0d080dc7c3318b854801d9d8887683c}{tcp\_\-checksum} (const void $\ast$buf, size\_\-t nchar, \_\-u32 saddr, \_\-u32 daddr)
\begin{CompactList}\small\item\em calculates tcp checksum on pseudo-header \item\end{CompactList}\item 
static \_\-u16 \hyperlink{classsocketpp_1_1TCP__RawSocket_1ac43948171803538577ca50dcd86402}{tcp\_\-checksum} (const std::string \&buf, \_\-u32 saddr, \_\-u32 daddr)
\begin{CompactList}\small\item\em calculates tcp checksum on pseudo-header \item\end{CompactList}\end{CompactItemize}
\subsection*{Protected Member Functions}
\begin{CompactItemize}
\item 
\hypertarget{classsocketpp_1_1TCP__RawSocket_bc5c2885494099eb5371d8e15cfce054}{
virtual void \textbf{\_\-build\_\-packet} (std::string \&packet) const }
\label{classsocketpp_1_1TCP__RawSocket_bc5c2885494099eb5371d8e15cfce054}

\item 
\hypertarget{classsocketpp_1_1TCP__RawSocket_6976a4726503eef03a8d446afdbaddbe}{
virtual void \textbf{\_\-set\_\-fields} (const std::string \&packet)}
\label{classsocketpp_1_1TCP__RawSocket_6976a4726503eef03a8d446afdbaddbe}

\end{CompactItemize}
\subsection*{Static Protected Member Functions}
\begin{CompactItemize}
\item 
\hypertarget{classsocketpp_1_1TCP__RawSocket_d8fd5e353a5960c652bd16a51840f148}{
static void \textbf{\_\-tcp\_\-convert} (const struct tcphdr \&, struct tcphdr \&)}
\label{classsocketpp_1_1TCP__RawSocket_d8fd5e353a5960c652bd16a51840f148}

\end{CompactItemize}
\subsection*{Protected Attributes}
\begin{CompactItemize}
\item 
\hypertarget{classsocketpp_1_1TCP__RawSocket_d1980411bd147dd67f6d9d9578414c17}{
tcphdr \textbf{TCP\_\-h}}
\label{classsocketpp_1_1TCP__RawSocket_d1980411bd147dd67f6d9d9578414c17}

\item 
\hypertarget{classsocketpp_1_1TCP__RawSocket_12b2d2f00d02c377301fc10e1209a8b8}{
tcphdr \textbf{rcvd\_\-TCP\_\-h}}
\label{classsocketpp_1_1TCP__RawSocket_12b2d2f00d02c377301fc10e1209a8b8}

\item 
\hypertarget{classsocketpp_1_1TCP__RawSocket_380529364d9488faf998543d433d8fe6}{
std::string \textbf{TCP\_\-opt}}
\label{classsocketpp_1_1TCP__RawSocket_380529364d9488faf998543d433d8fe6}

\item 
\hypertarget{classsocketpp_1_1TCP__RawSocket_b7bddcb31a7a310bcf61fcc474ded465}{
std::string \textbf{rcvd\_\-TCP\_\-opt}}
\label{classsocketpp_1_1TCP__RawSocket_b7bddcb31a7a310bcf61fcc474ded465}

\end{CompactItemize}


\subsection{Detailed Description}
TCP raw socket without IP header handling. 

\subsection{Member Function Documentation}
\hypertarget{classsocketpp_1_1TCP__RawSocket_0a1017145ae76253dfca51cbd672fae7}{
\index{socketpp::TCP\_\-RawSocket@{socketpp::TCP\_\-RawSocket}!adjust\_\-TCP\_\-all@{adjust\_\-TCP\_\-all}}
\index{adjust\_\-TCP\_\-all@{adjust\_\-TCP\_\-all}!socketpp::TCP_RawSocket@{socketpp::TCP\_\-RawSocket}}
\subsubsection[{adjust\_\-TCP\_\-all}]{\setlength{\rightskip}{0pt plus 5cm}void socketpp::TCP\_\-RawSocket::adjust\_\-TCP\_\-all (in\_\-addr\_\-t {\em source}, \/  in\_\-addr\_\-t {\em dest})}}
\label{classsocketpp_1_1TCP__RawSocket_0a1017145ae76253dfca51cbd672fae7}


calls \hyperlink{classsocketpp_1_1TCP__RawSocket_029eb8bfbf19531253edf046775d9f5f}{adjust\_\-TCP\_\-doff()} \&\& adjust\_\-TCP\_\-csum(source,dest) 

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em source}]IP source address \item[{\em dest}]IP destination address \end{description}
\end{Desc}
\hypertarget{classsocketpp_1_1TCP__RawSocket_c1a2ef8b2661bb0f3ca3fa6a636b25fd}{
\index{socketpp::TCP\_\-RawSocket@{socketpp::TCP\_\-RawSocket}!adjust\_\-TCP\_\-csum@{adjust\_\-TCP\_\-csum}}
\index{adjust\_\-TCP\_\-csum@{adjust\_\-TCP\_\-csum}!socketpp::TCP_RawSocket@{socketpp::TCP\_\-RawSocket}}
\subsubsection[{adjust\_\-TCP\_\-csum}]{\setlength{\rightskip}{0pt plus 5cm}void socketpp::TCP\_\-RawSocket::adjust\_\-TCP\_\-csum (in\_\-addr\_\-t {\em source}, \/  in\_\-addr\_\-t {\em dest})}}
\label{classsocketpp_1_1TCP__RawSocket_c1a2ef8b2661bb0f3ca3fa6a636b25fd}


sets the internal TCP pseudo-header checksum 

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em source}]IP source address \item[{\em dest}]IP destination address \end{description}
\end{Desc}
\hypertarget{classsocketpp_1_1TCP__RawSocket_8c35edfc4d8c2fbccf0fe13485dd2ef1}{
\index{socketpp::TCP\_\-RawSocket@{socketpp::TCP\_\-RawSocket}!build\_\-TCP\_\-header@{build\_\-TCP\_\-header}}
\index{build\_\-TCP\_\-header@{build\_\-TCP\_\-header}!socketpp::TCP_RawSocket@{socketpp::TCP\_\-RawSocket}}
\subsubsection[{build\_\-TCP\_\-header}]{\setlength{\rightskip}{0pt plus 5cm}void socketpp::TCP\_\-RawSocket::build\_\-TCP\_\-header (const tcphdr \& {\em tcp})}}
\label{classsocketpp_1_1TCP__RawSocket_8c35edfc4d8c2fbccf0fe13485dd2ef1}


builds the internal TCP header 

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em tcp}]TCP header \end{description}
\end{Desc}
\hypertarget{classsocketpp_1_1TCP__RawSocket_d7e8b2a67c856e11f0e6cfff5f8b8705}{
\index{socketpp::TCP\_\-RawSocket@{socketpp::TCP\_\-RawSocket}!get\_\-TCP\_\-header@{get\_\-TCP\_\-header}}
\index{get\_\-TCP\_\-header@{get\_\-TCP\_\-header}!socketpp::TCP_RawSocket@{socketpp::TCP\_\-RawSocket}}
\subsubsection[{get\_\-TCP\_\-header}]{\setlength{\rightskip}{0pt plus 5cm}void socketpp::TCP\_\-RawSocket::get\_\-TCP\_\-header (tcphdr \& {\em tcp})}}
\label{classsocketpp_1_1TCP__RawSocket_d7e8b2a67c856e11f0e6cfff5f8b8705}


gets the received TCP header 

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em tcp}]header to modify \end{description}
\end{Desc}
\hypertarget{classsocketpp_1_1TCP__RawSocket_67ab79f764a710067590427cb35aeea0}{
\index{socketpp::TCP\_\-RawSocket@{socketpp::TCP\_\-RawSocket}!get\_\-TCP\_\-options@{get\_\-TCP\_\-options}}
\index{get\_\-TCP\_\-options@{get\_\-TCP\_\-options}!socketpp::TCP_RawSocket@{socketpp::TCP\_\-RawSocket}}
\subsubsection[{get\_\-TCP\_\-options}]{\setlength{\rightskip}{0pt plus 5cm}size\_\-t socketpp::TCP\_\-RawSocket::get\_\-TCP\_\-options (std::string \& {\em opt})}}
\label{classsocketpp_1_1TCP__RawSocket_67ab79f764a710067590427cb35aeea0}


gets received TCP options 

string to fill \begin{Desc}
\item[Returns:]bytes written \end{Desc}
\hypertarget{classsocketpp_1_1TCP__RawSocket_75e954caea8187c5077821cd449199e7}{
\index{socketpp::TCP\_\-RawSocket@{socketpp::TCP\_\-RawSocket}!get\_\-TCP\_\-options@{get\_\-TCP\_\-options}}
\index{get\_\-TCP\_\-options@{get\_\-TCP\_\-options}!socketpp::TCP_RawSocket@{socketpp::TCP\_\-RawSocket}}
\subsubsection[{get\_\-TCP\_\-options}]{\setlength{\rightskip}{0pt plus 5cm}size\_\-t socketpp::TCP\_\-RawSocket::get\_\-TCP\_\-options (char $\ast$ {\em opt}, \/  size\_\-t {\em len})}}
\label{classsocketpp_1_1TCP__RawSocket_75e954caea8187c5077821cd449199e7}


gets received TCP options 

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em opt}]pointer to buffer to fill \item[{\em len}]max number of bytes to write \end{description}
\end{Desc}
\begin{Desc}
\item[Returns:]bytes written \end{Desc}
\hypertarget{classsocketpp_1_1TCP__RawSocket_7bc9043e86c6f328cb99d98c4bfca05a}{
\index{socketpp::TCP\_\-RawSocket@{socketpp::TCP\_\-RawSocket}!set\_\-TCP\_\-options@{set\_\-TCP\_\-options}}
\index{set\_\-TCP\_\-options@{set\_\-TCP\_\-options}!socketpp::TCP_RawSocket@{socketpp::TCP\_\-RawSocket}}
\subsubsection[{set\_\-TCP\_\-options}]{\setlength{\rightskip}{0pt plus 5cm}void socketpp::TCP\_\-RawSocket::set\_\-TCP\_\-options (const std::string \& {\em opt})}}
\label{classsocketpp_1_1TCP__RawSocket_7bc9043e86c6f328cb99d98c4bfca05a}


sets the TCP options field 

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em opt}]option string \end{description}
\end{Desc}
\hypertarget{classsocketpp_1_1TCP__RawSocket_c38e057fc6ece02026e71b7ee872533f}{
\index{socketpp::TCP\_\-RawSocket@{socketpp::TCP\_\-RawSocket}!set\_\-TCP\_\-options@{set\_\-TCP\_\-options}}
\index{set\_\-TCP\_\-options@{set\_\-TCP\_\-options}!socketpp::TCP_RawSocket@{socketpp::TCP\_\-RawSocket}}
\subsubsection[{set\_\-TCP\_\-options}]{\setlength{\rightskip}{0pt plus 5cm}void socketpp::TCP\_\-RawSocket::set\_\-TCP\_\-options (const char $\ast$ {\em opt}, \/  size\_\-t {\em len})}}
\label{classsocketpp_1_1TCP__RawSocket_c38e057fc6ece02026e71b7ee872533f}


sets the TCP options field 

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em opt}]pointer to option field \item[{\em len}]option length \end{description}
\end{Desc}
\hypertarget{classsocketpp_1_1TCP__RawSocket_1ac43948171803538577ca50dcd86402}{
\index{socketpp::TCP\_\-RawSocket@{socketpp::TCP\_\-RawSocket}!tcp\_\-checksum@{tcp\_\-checksum}}
\index{tcp\_\-checksum@{tcp\_\-checksum}!socketpp::TCP_RawSocket@{socketpp::TCP\_\-RawSocket}}
\subsubsection[{tcp\_\-checksum}]{\setlength{\rightskip}{0pt plus 5cm}static \_\-u16 socketpp::TCP\_\-RawSocket::tcp\_\-checksum (const std::string \& {\em buf}, \/  \_\-u32 {\em saddr}, \/  \_\-u32 {\em daddr})\hspace{0.3cm}{\tt  \mbox{[}static\mbox{]}}}}
\label{classsocketpp_1_1TCP__RawSocket_1ac43948171803538577ca50dcd86402}


calculates tcp checksum on pseudo-header 

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em buf}]packet string \item[{\em saddr}]IPv4 source address \item[{\em daddr}]IPv4 destination address \end{description}
\end{Desc}
\begin{Desc}
\item[Returns:]checksum value \end{Desc}
\hypertarget{classsocketpp_1_1TCP__RawSocket_a0d080dc7c3318b854801d9d8887683c}{
\index{socketpp::TCP\_\-RawSocket@{socketpp::TCP\_\-RawSocket}!tcp\_\-checksum@{tcp\_\-checksum}}
\index{tcp\_\-checksum@{tcp\_\-checksum}!socketpp::TCP_RawSocket@{socketpp::TCP\_\-RawSocket}}
\subsubsection[{tcp\_\-checksum}]{\setlength{\rightskip}{0pt plus 5cm}static \_\-u16 socketpp::TCP\_\-RawSocket::tcp\_\-checksum (const void $\ast$ {\em buf}, \/  size\_\-t {\em nchar}, \/  \_\-u32 {\em saddr}, \/  \_\-u32 {\em daddr})\hspace{0.3cm}{\tt  \mbox{[}static\mbox{]}}}}
\label{classsocketpp_1_1TCP__RawSocket_a0d080dc7c3318b854801d9d8887683c}


calculates tcp checksum on pseudo-header 

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em buf}]pointer to packet top \item[{\em nchar}]size of packet in bytes \item[{\em saddr}]IPv4 source address \item[{\em daddr}]IPv4 destination address \end{description}
\end{Desc}
\begin{Desc}
\item[Returns:]checksum value \end{Desc}


The documentation for this class was generated from the following files:\begin{CompactItemize}
\item 
RawSocket.h\item 
RawSocket.cpp\end{CompactItemize}
